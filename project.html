<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Project | Next Stop Labs</title>
    <meta name="description" content="Next Stop Labs project details." />
    <meta property="og:title" content="Project | Next Stop Labs" />
    <meta
      property="og:description"
      content="Explore detailed info about Next Stop Labs simulation projects."
    />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="https://avatars.githubusercontent.com/u/202529866?s=200&v=4" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Project | Next Stop Labs" />
    <meta
      name="twitter:description"
      content="Explore detailed info about Next Stop Labs simulation projects."
    />
    <meta name="twitter:image" content="https://avatars.githubusercontent.com/u/202529866?s=200&v=4" />
    <link rel="icon" href="https://avatars.githubusercontent.com/u/202529866?s=200&v=4" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <main class="page">
      <div class="page-actions">
        <button class="theme-toggle" type="button" aria-pressed="true">Dark mode</button>
      </div>
      <a class="card-button" href="index.html">Back to home</a>
      <section class="section project-hero" id="project-detail" aria-live="polite"></section>
    </main>

    <footer class="footer">
      <p>Next Stop Labs</p>
      <p>We like transport a little too much.</p>
    </footer>

    <script>
      const detailRoot = document.querySelector("#project-detail");
      const params = new URLSearchParams(window.location.search);
      const slug = params.get("project");

      const renderProject = (project) => {
        if (!detailRoot) {
          return;
        }

        detailRoot.innerHTML = "";

        const header = document.createElement("div");
        header.className = "project-hero";

        const title = document.createElement("h1");
        title.textContent = project.name;

        const tagline = document.createElement("p");
        tagline.className = "lead";
        tagline.textContent = project.tagline || project.summary || "";

        const description = document.createElement("p");
        description.textContent = project.description || project.summary || "";

        const meta = document.createElement("div");
        meta.className = "meta-list";

        if (project.status) {
          const status = document.createElement("span");
          status.className = "meta-pill";
          status.textContent = project.status;
          meta.appendChild(status);
        }

        header.appendChild(title);
        header.appendChild(tagline);
        header.appendChild(meta);
        header.appendChild(description);

        const actions = document.createElement("div");
        actions.className = "card-actions";

        if (project.website) {
          const websiteLink = document.createElement("a");
          websiteLink.className = "card-button";
          websiteLink.href = project.website;
          websiteLink.textContent = "Visit site";
          actions.appendChild(websiteLink);
        }

        if (project.repo) {
          const repoLink = document.createElement("a");
          repoLink.className = "card-button";
          repoLink.href = project.repo;
          repoLink.textContent = "View repo";
          actions.appendChild(repoLink);
        }

        detailRoot.appendChild(header);
        detailRoot.appendChild(actions);
      };

      const renderMissing = () => {
        if (!detailRoot) {
          return;
        }
        detailRoot.innerHTML =
          "<h1>Project not found</h1><p class=\"lead\">Please return to the home page and pick a project.</p>";
      };

      const loadProject = async () => {
        if (!slug) {
          renderMissing();
          return;
        }

        try {
          const response = await fetch("projects.json");
          if (!response.ok) {
            throw new Error("Could not load projects.");
          }
          const projects = await response.json();
          const project = projects.find((item) => item.slug === slug);
          if (!project) {
            renderMissing();
            return;
          }
          renderProject(project);
        } catch (error) {
          renderMissing();
        }
      };

      loadProject();
    </script>
  </body>
</html>
